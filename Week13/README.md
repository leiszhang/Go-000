##学习笔记

- 1）微服务架构（BFF、Service、Admin、Job、Task 分模块）
> 对于单个业务系统更改比较麻烦或者打包时间过长，可以采用微服务拆分，按公司成员架构和业务架构的情况进行拆分。     
> BFF: 组装调用微服务接口的业务逻辑和数据的地方  
> Service: 定义服务，可采用领域模型拆分业务  
> Admin: 存放后台代码管理的目录    
> Job: 存放任务（命令行、定时任务等）  
- 2）API 设计（包括 API 定义、错误码规范、Error 的使用）
> API设计: 定义公共的错误码   
> 定义顶层结构, [code, message ,data]    
> Error返回message    
- 3）gRPC 的使用
1. gRpc: 可以用pb文件定义接口，清晰可控，兼容性好，不易出错，还性能高，对越项目的接口可以采用pb文件，清晰可控，而且开发快，跨语言，可以解决这个问题。

- 4）Go 项目工程化（项目结构、DI、代码分层、ORM 框架）
> 工程化使用karatos的类似结构，定义清晰，管理方便
- 5）并发的使用（errgroup 的并行链路请求
> 并发错误处理: 错误只处理一次，而且是最上层处理，但底层代码出错时，使用errgroup向上抛出，不会突然某个地方错误处理了，某个地方又没有。
 
- 6）微服务中间件的使用（ELK、Opentracing、Prometheus、Kafka）
> 现有项目因为第三方API的速率限制，削峰填谷，而且页面上需要不阻塞，可操作，所以使用kafka队列，消息不易丢失，而且持久化了一段时间的消息，只要写到kafka里面，消息就不会丢失，不包括客户端自己消费丢失的情况。消息写入，顺序的磁盘写再加上pagecache的加成，10万条消息，iowait几乎为0。  
> ELK，用于日志的收集，因为ELK无人管理，暂且搁置。   
> Prometheus: 还未使用，暂时使用zabbix监控体系   
- 7）缓存的使用优化（一致性处理、Pipeline 优化
> 缓存：加速网站访问速度，因为redis和mysql两个地方都要存储数据，所有造成了分布式的数据处理，现在的业务情况是：redis可丢失，mysql保证原子性的写入就可以了。    
> 优化: redis缓存使用pipeline管道减少请求，go使用管道chanel使得多个goroutine可以通信。

#### 心得：
> 一个完整的思维流程，一个具体的系统分析，go的原理，以及中间件的原理和使用，架构上的设计思想，以及底层的原理分析，还有功能模块的真实案例，真的什么都有，通俗易懂，老师竭尽全力的讲解，值了！！

#### 学习方法
> 掌握一定的方法论解决日常，然后具体问题再具体分析。
> 每天进步一点点，每天都学习一点点，学习学习。

